ğŸ”¥ MongoDB INDEXING 
ğŸ”¹ BASE DATA (CONFIRM)


db.orders.find()


 OUTPUT


[
  { _id: 1, customer: "A", amount: 120, city: "Hyderabad", items: ["pen", "book"] },
  { _id: 2, customer: "B", amount: 80, city: "Bangalore", items: ["pencil"] },
  { _id: 3, customer: "A", amount: 200, city: "Hyderabad", items: ["book", "eraser"] },
  { _id: 4, customer: "C", amount: 300, city: "Chennai", items: ["bag"] }
]




 1ï¸âƒ£ SINGLE FIELD INDEX

 âœ… Code


db.orders.createIndex({ customer: 1 })


 âœ… Output (Shell)


customer_1




 ğŸ”¹ Query Using Index


db.orders.find({ customer: "A" })


 OUTPUT


[
  { _id: 1, customer: "A", amount: 120, city: "Hyderabad" },
  { _id: 3, customer: "A", amount: 200, city: "Hyderabad" }
]




 ğŸ”¹ Explain Output


db.orders.find({ customer: "A" }).explain("executionStats")


 OUTPUT (Simplified)


{
  "stage": "IXSCAN",
  "indexName": "customer_1",
  "totalDocsExamined": 2
}




 ğŸ§  Explanation

* MongoDB uses `customer_1` index
* No full collection scan
* Faster lookup



 2ï¸âƒ£ COMPOUND INDEX

 âœ… Code


db.orders.createIndex({ customer: 1, amount: -1 })


 âœ… Output


customer_1_amount_-1




 ğŸ”¹ Query + Sort


db.orders.find({ customer: "A" }).sort({ amount: -1 })


 OUTPUT


[
  { _id: 3, customer: "A", amount: 200 },
  { _id: 1, customer: "A", amount: 120 }
]




 ğŸ”¹ Explain


db.orders.find({ customer: "A" }).sort({ amount: -1 }).explain("executionStats")


 OUTPUT


{
  "stage": "IXSCAN",
  "indexName": "customer_1_amount_-1"
}




 3ï¸âƒ£ MULTIKEY INDEX (ARRAY)

 âœ… Code


db.orders.createIndex({ items: 1 })


 âœ… Output


items_1




 ğŸ”¹ Query


db.orders.find({ items: "book" })


 OUTPUT


[
  { _id: 1, items: ["pen", "book"] },
  { _id: 3, items: ["book", "eraser"] }
]




 4ï¸âƒ£ TEXT INDEX

 âœ… Code


db.orders.createIndex({ items: "text" })


 âœ… Output


items_text




 ğŸ”¹ Query


db.orders.find({ $text: { $search: "book" } })


 OUTPUT


[
  { _id: 1, items: ["pen", "book"] },
  { _id: 3, items: ["book", "eraser"] }
]




 5ï¸âƒ£ HASHED INDEX

 âœ… Code


db.orders.createIndex({ customer: "hashed" })


 âœ… Output


customer_hashed




 ğŸ”¹ Query


db.orders.find({ customer: "A" })


 OUTPUT


[
  { _id: 1, customer: "A" },
  { _id: 3, customer: "A" }
]




 ğŸ”¹ Explain


db.orders.find({ customer: "A" }).explain()


 OUTPUT


{
  "indexName": "customer_hashed",
  "stage": "IXSCAN"
}




 6ï¸âƒ£ GEO-SPATIAL INDEX

 âœ… Insert


db.places.insertOne({
  name: "Park",
  location: {
    type: "Point",
    coordinates: [78.4867, 17.3850]
  }
})


db.places.deleteOne({name:"Park"})




 âœ… Code


db.places.createIndex({ location: "2dsphere" })


 âœ… Output


location_2dsphere




 ğŸ”¹ Query


db.places.find({
  location: {
    $near: {
      $geometry: {
        type: "Point",
        coordinates: [78.4867, 17.3850]
      },
      $maxDistance: 5000
    }
  }
})


 OUTPUT


[
  {
    name: "Park",
    location: {
      type: "Point",
      coordinates: [78.4867, 17.3850]
    }
  }
]




 7ï¸âƒ£ PARTIAL INDEX

 âœ… Code


db.orders.createIndex(
  { customer: 1 },
  { partialFilterExpression: { amount: { $gt: 100 } } }
)


 âœ… Output


customer_1




 ğŸ”¹ Query


db.orders.find({ customer: "A", amount: { $gt: 100 } })


 OUTPUT


[
  { _id: 1, amount: 120 },
  { _id: 3, amount: 200 }
]




 8ï¸âƒ£ TTL INDEX

 âœ… Insert


db.logs.insertOne({
  message: "temp log",
  createdAt: new Date()
})




 âœ… Code


db.logs.createIndex(
  { createdAt: 1 },
  { expireAfterSeconds: 10 }
)


 âœ… Output


createdAt_1




 ğŸ”¹ After 1 Hour


db.logs.find()


 OUTPUT


[]




 9ï¸âƒ£ UNIQUE INDEX

 âœ… Code


db.users.createIndex(
  { email: 1 },
  { unique: true }
)




 ğŸ”¹ Insert Duplicate


db.users.insertOne({ email: "test@gmail.com" })
db.users.insertOne({ email: "test@gmail.com" })


 OUTPUT (ERROR)


E11000 duplicate key error collection




 ğŸ”Ÿ CASE-INSENSITIVE INDEX

 âœ… Code


db.users.createIndex(
  { name: 1 },
  { collation: { locale: "en", strength: 2 } }
)




 ğŸ”¹ Query


db.users.find(
  { name: "alice" }
).collation({ locale: "en", strength: 2 })


 OUTPUT


[
  { name: "Alice" }
]
